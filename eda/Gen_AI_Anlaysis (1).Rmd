---
title: "Gen"
author: "Brandon"
date: "2025-08-01"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r}
packages <- c("dplyr", "ggplot2", "skimr", "readr", "corrplot")
installed <- rownames(installed.packages())
to_install <- packages[!packages %in% installed]
if(length(to_install)) install.packages(to_install)

library(dplyr)
library(ggplot2)
library(skimr)
library(readr)
library(corrplot)

```


```{r}
head(Gen)
```

```{r}
names(Gen) <- c(
  "company",
  "industry",
  "country",
  "gen_tool",
  "adoption_year",
  "num_employees_impacted",
  "new_roles_created",
  "training_hours",
  "productivity_change",
  "employee_sentiment")

head(Gen)
```



```{r}
summary(select(Gen, adoption_year, productivity_change, training_hours, new_roles_created, num_employees_impacted))
```
Real quick summary of each one nothing too crazy as of now will decide to pull individuals if needed

```{r}
ggplot(Gen, aes(x = productivity_change)) + 
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Productivity Change")

ggplot(Gen, aes(x = adoption_year)) + 
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of adoption year")

ggplot(Gen, aes(x = training_hours)) + 
  geom_histogram(binwidth = 100, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of Training Hours",
       x = "Training Hours",
       y = "Count")

ggplot(Gen, aes(x = new_roles_created)) + 
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of new roles created")

ggplot(Gen, aes(x = num_employees_impacted)) + 
  geom_histogram(binwidth = 100, fill = "skyblue", color = "black") +
  theme_minimal() +
  labs(title = "Distribution of number of empolyees impacted")

```

```{r}
summary(Gen[, c("training_hours", "num_employees_impacted")])

```
Decided to look at these two because they required a lot of bins


```{r}
ggplot(Gen, aes(x = industry)) +
  geom_bar(fill = "skyblue") +
  theme_minimal() +
  labs(title = "Count by Industry", x = "Industry", y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(Gen, aes(x = country)) +
  geom_bar(fill = "skyblue") +
  theme_minimal() +
  labs(title = "Count by Country", x = "Country", y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

ggplot(Gen, aes(x = gen_tool)) +
  geom_bar(fill = "skyblue") +
  theme_minimal() +
  labs(title = "Count by Generative Tool", x = "Gen Tool", y = "Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
At this point I found that company was going to be kind of useless as there are 100k unique values so decided to drop if moving forward


```{r}
num_vars <- c("adoption_year", "productivity_change", "training_hours", "new_roles_created", "num_employees_impacted")

cor_mat <- cor(Gen[, num_vars], use = "complete.obs")
corrplot(cor_mat, method = "color", addCoef.col = "black", number.cex = 0.8, tl.cex = 1, tl.srt = 45)
```

```{r}
cor_matrix <- cor(Gen[, num_vars], use = "complete.obs")

print(round(cor_matrix, 3))

```
went with both visual and tabular to better understand the relationships, so as of this no multicollinearity for now but we can dive into that when anlayzing the model.

```{r}
cat_vars <- c("company", "industry", "country", "gen_tool")
Gen[cat_vars] <- lapply(Gen[cat_vars], factor)
```
Decided to throw in categorical variables to see what would happen so I factored them, turns out we can use years as categroical since there are only 3 years but we can decide that later, wanted to try it out as a numerical value

```{r}
model <- lm(productivity_change ~ adoption_year + training_hours + new_roles_created +
            num_employees_impacted + industry + country + gen_tool, data = Gen)

summary(model)

```
Wanted to run the model on everything just to see how we do 
My interpretation
The model explains almost none of the variation in productivity change, the R-squared is very close to zero 0.00034, meaning the predictors combined do not significantly predict productivity change.

None of the predictors showed statistically significant relationships with productivity change all p-values are > 0.05

The overall model is not statistically significant F-statistic p-value = 0.52, meaning we cannot conclude this set of variables reliably predicts productivity change.

Residual standard error 9.53 indicates there is considerable unexplained variation in productivity change.

Conclusion: Model does not provide useful insight into what drives productivity change in the data

```{r}
residuals <- resid(model)

summary(residuals)

```



```{r}
plot(model$fitted.values, model$residuals,
     main = "Residuals vs Fitted",
     xlab = "Fitted Values", ylab = "Residuals", col = "black")
abline(h = 0, col = "red", lwd = 2)

qqnorm(resid(model))
qqline(resid(model), col = "red", lwd = 2)
```

```{r}
new_data <- Gen[1:5, ]


predictions <- predict(model, newdata = new_data)

results <- data.frame(
  Actual = new_data$productivity_change,
  Predicted = predictions,
  Error = new_data$productivity_change - predictions)

print(results)

mae <- mean(abs(results$Error))
mse <- mean(results$Error^2)

cat("MAE:", mae, "\nMSE:", mse, "\n")
```
Decided to test the model just to see how it would actually do
MAE = 10.05 means that our model’s predictions are off by about 10 units from the actual productivity change values on average.
MSE = 112.55 gives more weight to larger errors and shows that the squared differences between predicted and actual values average around 112.5.

Bad, but again this was without any actual adjustments and or deep dives just a quick run of everything to see where we stand. Only real thing was I removed company and employment sentiment 

```{r}

back_model <- lm(productivity_change ~ training_hours + new_roles_created +
            num_employees_impacted + industry + gen_tool, data = Gen)

back_model <- step(back_model, direction = 'backward', trace = TRUE)


```


```{r}

summary(back_model)


```


```{r}

# 1) Define the null (intercept‐only) model
null_mod <- lm(productivity_change ~ 1, data = Gen)

# 2) Define the full formula (all candidates)
full_form <- productivity_change ~ training_hours +
              new_roles_created + num_employees_impacted +
              industry + gen_tool

# 3) Run forward stepwise
forward_model <- step(null_mod,
                      scope    = list(lower=null_mod, upper=full_form),
                      direction = "forward",
                      trace     = TRUE)


```


```{r}

summary(forward_model)

```


```{r}

# Both‐directions stepwise
both_model <- step(null_mod,
                   scope     = full_form,
                   direction = "both",
                   trace     = TRUE)

summary(both_model)


```


```{r}

library(MASS)

# Box cox on initial model
bc_full <- boxcox(
  model,
  lambda = seq(-2, 2, by = 0.1),
  plotit = TRUE
)

# lambda
best_lambda_full <- bc_full$x[which.max(bc_full$y)]
cat("Suggested lambda for initial model:", best_lambda_full, "\n")

```



```{r}

# Install car
if (!"car" %in% installed.packages()) install.packages("car")
library(car)

# Check multicollinearity on model

vif(model)

```


```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```

```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```


```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```

```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```

```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```

```{r}

```


```{r}

```

```{r}

```


